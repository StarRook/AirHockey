<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IceHockey</title>
</head>
<body>
    <canvas id="canvas" style="border: 1px solid black;" width="1800" height="900"></canvas>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      $(function () {

        /* FUNCTIONS START */

        const drawScore = () => {

        };

        const drawLine = (color, x1, y1, x2, y2) => {
            ctx.beginPath();
            ctx.strokeStyle = color;
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();
        };

        const drawArc = (color, x, y, r, fill) => {
          ctx.beginPath();
          if (fill) {
            ctx.fillStyle = color;
          } else {
            ctx.strokeStyle = color;
          }
          ctx.arc(x, y, r, 0, 2 * Math.PI);
          ctx.closePath();
          if (fill) {
            ctx.fill();
          } else {
            ctx.stroke();
          }
        };

        const drawLinesToField = () => {

          drawLine('#9d0000', 900, 0, 900, 900);
          drawArc('#9d0000', 900, 450, 50, false);
          drawLine('#00009d', 550, 0, 550, 900);
          drawLine('#00009d', 1250, 0, 1250, 900);
          drawArc('#9d0000', 900, 450, 12, true);

        };

        /* FUNCTIONS END */

        const socket = io();

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext("2d");

        canvas.addEventListener('mousemove', (event) => {
          socket.emit('move', [event.clientX, event.clientY]);
        });

        socket.on('update', (data) => {
          console.log(data);

          ctx.clearRect(0, 0, 1800, 900);

          drawLinesToField();

          for (const player of data.players) {

            let fillStyle = '#0c2984';

            if (player.no === 1) {
              fillStyle = '#ad222d';
            }

            drawArc(fillStyle, player.x, player.y, 35, true);
          }

          const puck = data.puck;

          drawArc(puck.color, puck.x, puck.y, puck.r, true);

        });
      });
    </script>
</body>
</html>